diff -ur opie-2.32.orig/Makefile.in opie-2.32/Makefile.in
--- opie-2.32.orig/Makefile.in	Tue Apr 25 04:41:37 2000
+++ opie-2.32/Makefile.in	Tue Apr 25 05:12:18 2000
@@ -110,6 +110,8 @@
 MKDIR=@MKDIR@
 CHOWN=@CHOWN@
 LOCALBIN=@LOCALBIN@
+LOCALSBIN=@LOCALSBIN@
+LOCALLIB=@LOCALLIB@
 LOCALMAN=@LOCALMAN@
 SU=@SU@
 ALT_SU=@ALT_SU@
@@ -133,73 +135,38 @@
 client-install: client
 	@echo "Installing OPIE client software..."
 	@echo "Copying OPIE key-related files"
-	@if test ! -d $(LOCALBIN); then $(MKDIR) $(LOCALBIN); chmod 755 $(LOCALBIN); fi 
-	@cp opiekey $(LOCALBIN)
-	@$(CHOWN) $(OWNER) $(LOCALBIN)/opiekey
-	@chgrp $(GROUP) $(LOCALBIN)/opiekey
+	@if test ! -d $(DESTDIR)$(LOCALBIN); then $(MKDIR) $(DESTDIR)$(LOCALBIN); fi 
+	@cp opiekey $(DESTDIR)$(LOCALBIN)
 	@echo "Changing file permissions"
-	@chmod 0511 $(LOCALBIN)/opiekey
 	@echo "Symlinking aliases to opiekey"
-	@-ln -s $(LOCALBIN)/opiekey $(LOCALBIN)/otp-md4
-	@-ln -s $(LOCALBIN)/opiekey $(LOCALBIN)/otp-md5
+	@-ln -s opiekey $(DESTDIR)$(LOCALBIN)/otp-md4
+	@-ln -s opiekey $(DESTDIR)$(LOCALBIN)/otp-md5
 	@echo "Installing manual pages"
-	@-for i in otp-md4 otp-md5; do ln -s opiekey.1 $(LOCALMAN)/man1/$$i.1; done
-	@if test ! -d $(LOCALMAN)/man1; then $(MKDIR) $(LOCALMAN)/man1; chmod 755 $(LOCALMAN)/man1; fi; cp opiekey.1 $(LOCALMAN)/man1/opiekey.1; $(CHOWN) $(OWNER) $(LOCALMAN)/man1/opiekey.1; chgrp $(GROUP) $(LOCALMAN)/man1/opiekey.1; chmod 644 $(LOCALMAN)/man1/opiekey.1
+	@if test ! -d $(DESTDIR)$(LOCALMAN)/man1; then $(MKDIR) $(DESTDIR)$(LOCALMAN)/man1; fi; cp opiekey.1 $(DESTDIR)$(LOCALMAN)/man1/opiekey.1;
+	@-for i in otp-md4 otp-md5; do echo ".so opiekey.1" > $(DESTDIR)$(LOCALMAN)/man1/$$i.1; done
 
 server:	libopie/libopie.a libopie/libopie.so libmissing/libmissing.a opietest-passed opielogin opiesu opiepasswd opieinfo opieftpd opieserv
 
 server-install: server
 	@echo "Installing OPIE server software..."
 	@echo "Copying OPIE user programs"
-	@if test ! -d $(LOCALBIN); then $(MKDIR) $(LOCALBIN); chmod 755 $(LOCALBIN); fi 
-	@cp opiepasswd opieinfo $(LOCALBIN)
+	@if test ! -d $(DESTDIR)$(LOCALBIN); then $(MKDIR) $(DESTDIR)$(LOCALBIN); fi 
+	@cp opiepasswd opieinfo $(DESTDIR)$(LOCALBIN)
 	@echo "Changing ownership"
-	@$(CHOWN) $(OWNER) $(LOCALBIN)/opiepasswd $(LOCALBIN)/opieinfo
-	@chgrp $(GROUP) $(LOCALBIN)/opiepasswd $(LOCALBIN)/opieinfo
-	@echo "Changing file permissions"
-	@chmod 0555 $(LOCALBIN)/opieinfo
-	@chmod 4511 $(LOCALBIN)/opiepasswd
 	@echo "Installing OPIE system programs..."
-	@if test ! $(EXISTS) $(LOGIN).$(BACKUP); then echo "Renaming existing $(LOGIN) to $(LOGIN).$(BACKUP)"; mv $(LOGIN) $(LOGIN).$(BACKUP); echo "Clearing permissions on old $(LOGIN)"; chmod 0 $(LOGIN).$(BACKUP); fi
-	@echo "Copying opielogin to $(LOGIN)"
-	@cp opielogin $(LOGIN)
-	@echo "Changing ownership of $(LOGIN)"
-	@$(CHOWN) $(OWNER) $(LOGIN)
-	@chgrp $(GROUP) $(LOGIN)
-	@echo "Changing file permissions of $(LOGIN)"
-	@chmod 4111 $(LOGIN)
-	@if test ! $(EXISTS) $(SU).$(BACKUP); then echo "Renaming existing su to su.$(BACKUP)"; mv $(SU) $(SU).$(BACKUP); echo "Clearing permissions on old su"; chmod 0 $(SU).$(BACKUP); fi
-	@-if test ! -z "$(ALT_SU)"; then if test ! $(EXISTS) $(ALT_SU).$(BACKUP); then echo "Renaming existing su to su.$(BACKUP)"; mv $(ALT_SU) $(ALT_SU).$(BACKUP); fi; echo "Copying opiesu to su"; cp opiesu $(ALT_SU); echo "Changing ownership"; $(CHOWN) $(OWNER) $(ALT_SU); chgrp $(GROUP) $(ALT_SU); echo "Changing file permissions"; chmod 4111 $(ALT_SU); echo "Clearning permissions on old su"; chmod 0 $(ALT_SU).$(BACKUP); fi
-	@echo "Copying opiesu to su"
-	@cp opiesu $(SU)
-	@echo "Changing ownership of su"
-	@$(CHOWN) $(OWNER) $(SU)
-	@chgrp $(GROUP) $(SU)
-	@echo "Changing file permissions of su"
-	@chmod 4111 $(SU)
-	@if test ! $(EXISTS) $(FTPD).$(BACKUP); then echo "Renaming existing ftp daemon to $(FTPD).$(BACKUP)"; mv $(FTPD) $(FTPD).$(BACKUP); echo "Clearing permissions on old ftp daemon"; chmod 0 $(FTPD).$(BACKUP); fi
-	@echo "Copying OPIE ftp daemon"
-	@cp opieftpd $(FTPD)
-	@echo "Changing ownership of ftpd"
-	@$(CHOWN) $(OWNER) $(FTPD)
-	@chgrp $(GROUP) $(FTPD)
-	@echo "Changing file permissions of ftpd"
-	@chmod 0100 $(FTPD)
+	@cp opieftpd opiesu opielogin $(DESTDIR)$(LOCALSBIN)
 	@echo "Making sure OPIE database file exists"
-	@touch $(KEY_FILE)
+	@touch $(DESTDIR)$(KEY_FILE)
 	@echo "Changing permissions of OPIE database file"
-	@chmod 0644 $(KEY_FILE)
-	@echo "Changing ownership of OPIE database file"
-	@$(CHOWN) $(OWNER) $(KEY_FILE)
-	@chgrp $(GROUP) $(KEY_FILE)
-	@-if test ! -z "$(LOCK_DIR)"; then echo "Creating OPIE lock directory"; mkdir $(LOCK_DIR); $(CHOWN) 0 $(LOCK_DIR); chgrp 0 $(LOCK_DIR); chmod 0700 $(LOCK_DIR); fi;
-	@-if test ! -z "$(ACCESS_FILE)"; then echo "Creating OPIE access file (don't say we didn't warn you)"; touch $(ACCESS_FILE); $(CHOWN) 0 $(ACCESS_FILE); chgrp 0 $(ACCESS_FILE); chmod 0444 $(ACCESS_FILE); fi;
+	@-if test ! -z "$(DESTDIR)$(LOCK_DIR)"; then echo "Creating OPIE lock directory"; mkdir $(DESTDIR)$(LOCK_DIR); fi;
+	@-if test ! -z "$(DESTDIR)$(ACCESS_FILE)"; then echo "Creating OPIE access file (don't say we didn't warn you)"; touch $(DESTDIR)$(ACCESS_FILE); fi;
 	@echo "Installing manual pages"
-	@if test ! -d $(LOCALMAN); then $(MKDIR) $(LOCALMAN); chmod 755 $(LOCALMAN); fi
-	@for i in 1 4 5 8; do for j in *.$$i; do if test ! -d $(LOCALMAN)/man$$i; then $(MKDIR) $(LOCALMAN)/man$$i; chmod 755 $(LOCALMAN)/man$$i; fi; cp $$j $(LOCALMAN)/man$$i/$$j; $(CHOWN) $(OWNER) $(LOCALMAN)/man$$i/$$j; chgrp $(GROUP) $(LOCALMAN)/man$$i/$$j; chmod 644 $(LOCALMAN)/man$$i/$$j; done; done
+	@if test ! -d $(DESTDIR)$(LOCALMAN); then $(MKDIR) $(DESTDIR)$(LOCALMAN); fi
+	@for i in 1 4 5 8; do for j in *.$$i; do if test ! -d $(DESTDIR)$(LOCALMAN)/man$$i; then $(MKDIR) $(DESTDIR)$(LOCALMAN)/man$$i; fi; cp $$j $(DESTDIR)$(LOCALMAN)/man$$i/$$j; done; done
 	@echo "REMEMBER to run opiepasswd on your users immediately."
 
 install: client-install server-install
+	(cd libopie ; $(MAKE) install LOCALLIB=$(LOCALLIB))
 
 uninstall:
 	@echo "Un-installing OPIE..."
diff -ur opie-2.32.orig/configure.munger.in opie-2.32/configure.munger.in
--- opie-2.32.orig/configure.munger.in	Thu Aug 22 15:50:35 1996
+++ opie-2.32/configure.munger.in	Tue Apr 25 05:14:28 2000
@@ -1,16 +1,20 @@
 prefix=@prefix@
 exec_prefix=@exec_prefix@
 bindir=@bindir@
+sbindir=@sbindir@
 mandir=@mandir@
+libdir=@libdir@
 
 LOCALBIN=$bindir
+LOCALSBIN=$sbindir
 LOCALMAN=$mandir
+LOCALLIB=$libdir
 
 echo ""
 echo "Binaries are going to be installed into $LOCALBIN,"
 echo "Manual pages are going to be installed into $LOCALMAN."
 echo ""
 echo "creating Makefile"
-cat Makefile.munge | sed s:@LOCALMAN@:$LOCALMAN:g | sed s:@LOCALBIN@:$LOCALBIN:g > Makefile
+cat Makefile.munge | sed s:@LOCALMAN@:$LOCALMAN:g | sed s:@LOCALLIB@:$LOCALLIB:g | sed s:@LOCALSBIN@:$LOCALSBIN:g | sed s:@LOCALBIN@:$LOCALBIN:g > Makefile
 echo ""
 echo "Have you read the README file?"
Binary files opie-2.32.orig/libmissing/libmissing.a and opie-2.32/libmissing/libmissing.a differ
diff -ur opie-2.32.orig/libopie/Makefile.in opie-2.32/libopie/Makefile.in
--- opie-2.32.orig/libopie/Makefile.in	Tue Apr 25 04:41:37 2000
+++ opie-2.32/libopie/Makefile.in	Tue Apr 25 05:12:18 2000
@@ -31,6 +31,11 @@
 	ld -o $(TARGETS).$(MAJOR).$(MINOR) -soname $(TARGETS).$(MAJOR) -shared $(OBJS)
 	ln -s $(TARGETS).$(MAJOR).$(MINOR) $(TARGETS)
 
+install: $(TARGET) $(TARGETS)
+	install $(TARGET) $(DESTDIR)$(LOCALLIB)
+	install $(TARGETS).$(MAJOR).$(MINOR) $(DESTDIR)$(LOCALLIB)
+	ln -s $(TARGETS).$(MAJOR).$(MINOR) $(DESTDIR)$(LOCALLIB)/$(TARGETS)
+
 clean:
 	-rm -f $(OBJS) $(TARGET)
 
